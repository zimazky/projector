(()=>{"use strict";class e{static WEEKDAYS=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];static MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];static MONTHS_FULL=["January","February","March","April","May","June","July","August","September","October","November","December"];static startWeek=1;static timezone=3;static initLocale(t=3,a=1){e.timezone=t,e.startWeek=a}static getDayMonthWeekday(e){const t=new Date(1e3*e);return{day:t.getDate(),month:t.getMonth(),weekday:t.getDay()}}static getWeekday(e){return new Date(1e3*e).getDay()}static getBegintWeekTimestamp(t){const a=new Date(1e3*t);a.setHours(0,0,0,0);const n=a.getDate();let r=a.getDay()-e.startWeek;return r<0&&(r+=7),a.setDate(n-r)/1e3}static getBeginDayTimestamp=e=>new Date(1e3*e).setHours(0,0,0,0)/1e3;static getEndDayTimestamp=t=>86400*~~((t+3600*e.timezone)/86400)-3600*e.timezone+86399;static getTime=t=>t-e.getBeginDayTimestamp(t);static getTimeToEndDay=t=>e.getBeginDayTimestamp(t)+86399-t;static getDifferenceInDays=(t,a)=>(e.getBeginDayTimestamp(a)-e.getBeginDayTimestamp(t))/86400;static getTimeString(e){const t=new Date(1e3*e),a=t.getUTCHours(),n=t.getUTCMinutes();return a+(n>9?":":":0")+n}static getYYYYMMDD(e){const t=new Date(1e3*e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return a+(n>9?"-":"-0")+n+(r>9?"-":"-0")+r}static getHHMM(e){const t=new Date(1e3*e),a=t.getHours(),n=t.getMinutes();return(a>9?"":"0")+a+(n>9?":":":0")+n}static getYYYYMMDDTHHMM(e){const t=new Date(1e3*e),a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),c=t.getHours(),i=t.getMinutes();return a+(n>9?"-":"-0")+n+(r>9?"-":"-0")+r+(c>9?"T":"T0")+c+(i>9?":":":0")+i}static HHMMToSeconds(e){if(!e)return 0;const[t,a]=e.split(":",2);return 60*(60*t+ +a)}static DDHHMMToSeconds(t){const[a,n]=t.split("d",2);return void 0===n?e.HHMMToSeconds(a):86400*a+e.HHMMToSeconds(n)}static HHMMFromSeconds(e){if(null===e)return"";const t=~~(e%3600/60);return~~(e/3600)+(t>9?":":":0")+t}static DDHHMMFromSeconds(t){if(t<0)return"";const a=~~(t/86400);return(a<1?"":a+"d ")+e.HHMMFromSeconds(t%86400)}}function t(e,t,a=31,n=1){const[r,c=null]=t.split("-",2);if(null===c){const[r,c=null]=t.split("/",2);if(""===r||""===c)return e;const i="*"===r?n:+r;let s=+c;if(isNaN(i)||isNaN(s))return e;if(null===c&&"*"!==r)return e.push(+r),e;0===s&&(s=1);for(let t=i;t<=a;t+=s)e.push(t);return e}if(""===r||""===c)return e;for(let t=+r;t<=+c;t++)e.push(t);return e}class a{static isMatch(a,n,r){const{day:c,month:i,weekday:s}=e.getDayMonthWeekday(r),[d=null,l="*",o="*"]=a.trim().split(" ",3);if(null===d)return!1;if("/"===d[0]){const t=~~((r-e.getBeginDayTimestamp(n))/86400);return!(t<0)&&t%+d.substring(1)==0}const m=d.split(",").reduce(((e,a)=>t(e,a)),[]),u=l.split(",").reduce(((e,a)=>t(e,a,12)),[]),p=o.split(",").reduce(((e,a)=>t(e,a,7,0)),[]);return!!(u.includes(i+1)&&m.includes(c)&&p.includes(s))}static ariseInInterval(e,t,a,n){for(var r=a;r<n;r+=86400)if(this.isMatch(e,t,r))return!0;return!1}}const n=(e,t,a)=>({id:e,name:t.name,comment:t.comment,project:t.project,background:t.background,color:t.color,start:a,time:t.time,end:a+86400,days:1,credit:t.credit,debit:t.debit}),r=(e,t,a)=>({id:e.id,name:e.name,background:e.background,color:e.color,start:e.start,time:e.time,end:e.end,days:Math.ceil((e.end-t)/86400),credit:e.credit,debit:e.debit,completed:a});class c{static default_background="lightgray";static default_color="black";static rawToEvent=t=>{const a=e.getBeginDayTimestamp(new Date(t.start)/1e3),n=t.time?e.HHMMToSeconds(t.time):null,r=t.duration?e.DDHHMMToSeconds(t.duration):0;if(t.repeat)return{name:t.name,comment:t.comment??"",project:t.project??"",repeat:t.repeat,start:a,time:n,duration:r,end:t.end?e.getBeginDayTimestamp(new Date(t.end)/1e3):0,credit:t.credit??0,debit:t.debit??0};const c=r?(null!==n?a+n:a)+r:t.end?e.getBeginDayTimestamp(new Date(t.end)/1e3):a+86400;return{name:t.name,comment:t.comment??"",project:t.project??"",start:a,time:n,duration:r,end:c,credit:t.credit??0,debit:t.debit??0}};static eventToRaw=t=>{const a={};return a.name=t.name,t.comment&&(a.comment=t.comment),t.project&&(a.project=t.project),a.start=e.getYYYYMMDD(t.start),null!==t.time&&(a.time=e.HHMMFromSeconds(t.time)),t.repeat?(a.repeat=t.repeat,t.duration&&(a.duration=e.DDHHMMFromSeconds(t.duration)),t.end&&(a.end=e.getYYYYMMDD(t.end))):t.duration?a.duration=e.DDHHMMFromSeconds(t.duration):t.end&&t.end-t.start!=86400&&(a.end=e.getYYYYMMDD(t.end)),t.credit&&(a.credit=t.credit),t.debit&&(a.debit=t.debit),a};constructor(e=[],t=[],a=[]){this.cachedEvents=[],this.cachedActualBalance=[],this.cachedPlannedBalance=[],this.lastId=1,this.projects=[...a],this.completed=[],e.forEach((e=>{const t=c.rawToEvent(e);this.addCompletedEvent(t)})),this.planned=[],this.plannedRepeatable=[],t.forEach((e=>this.addPlannedRawEvent(e))),this.sort(),this.lastActualBalance=this.calculateActualBalance(),this.lastActualBalanceDate=this.completed.length?this.completed[this.completed.length-1].start:0,this.firstActualBalanceDate=this.completed.length?this.completed[0].start:0}addCompletedEvent(e){const t=e.project?this.projects.find((t=>t.name===e.project)):{name:"",background:c.default_background,color:c.default_color};this.completed.push({id:this.lastId++,name:e.name,comment:e.comment,project:t.name,background:t.background,color:t.color,start:e.start,time:e.time,duration:e.duration,end:e.end,days:Math.ceil((e.end-e.start)/86400),credit:e.credit,debit:e.debit})}addPlannedRawEvent(e){this.addPlannedEvent(c.rawToEvent(e))}addPlannedEvent(e){const t=e.project?this.projects.find((t=>t.name===e.project)):{name:"",background:c.default_background,color:c.default_color};e.repeat?this.plannedRepeatable.push({id:this.lastId++,name:e.name,comment:e.comment,project:t.name,background:t.background,color:t.color,repeat:e.repeat,start:e.start,time:e.time,duration:e.duration,end:e.end,days:1,credit:e.credit,debit:e.debit}):this.planned.push({id:this.lastId++,name:e.name,comment:e.comment,project:t.name,background:t.background,color:t.color,start:e.start,time:e.time,duration:e.duration,end:e.end,days:Math.ceil((e.end-e.start)/86400),credit:e.credit,debit:e.debit})}clearCache(){this.cachedEvents=[],this.cachedActualBalance=[],this.cachedPlannedBalance=[],this.lastActualBalance=this.calculateActualBalance(),this.lastActualBalanceDate=this.completed.length?this.completed[this.completed.length-1].start:0,this.firstActualBalanceDate=this.completed.length?this.completed[0].start:0}deleteEvent(e){this.completed=this.completed.filter((t=>t.id!==e)),this.planned=this.planned.filter((t=>t.id!==e)),this.plannedRepeatable=this.plannedRepeatable.filter((t=>t.id!==e)),this.clearCache()}completeEvent(e,t,r={}){var i=this.completed.find((t=>t.id===e));if(void 0!==i)return this.addPlannedEvent({...i,...c.rawToEvent(r)}),this.sort(),void this.deleteEvent(i.id);if(void 0!==(i=this.planned.find((t=>t.id===e))))return this.addCompletedEvent({...i,...c.rawToEvent(r)}),this.sort(),void this.deleteEvent(i.id);if(void 0!==(i=this.plannedRepeatable.find((t=>t.id===e)))){const e=n(this.lastId++,{...i,...c.rawToEvent(r)},t);if(this.completed.push(e),a.ariseInInterval(i.repeat,i.start,i.start,t)){const e={...i,end:t,id:this.lastId++};this.plannedRepeatable.push(e)}if("/"==i.repeat[0]){const e=+i.repeat.substr(1);i.start=t+86400*e}else i.start=t+86400;return i.end&&!a.ariseInInterval(i.repeat,i.start,i.start,i.end)&&this.deleteEvent(i.id),this.sort(),void this.clearCache()}}sort(){this.completed.sort(((e,t)=>{const a=e.start-t.start;return 0===a?t.days-e.days:a})),this.planned.sort(((e,t)=>{const a=e.start-t.start;return 0===a?t.days-e.days:a})),this.plannedRepeatable.sort(((e,t)=>e.time-t.time))}getEvents(e){if(void 0!==this.cachedEvents[e])return this.cachedEvents[e];const t=this.planned.reduce(((t,a)=>(e<a.start||e>=a.end||t.push(r(a,e,!1)),t)),[]);return this.plannedRepeatable.reduce(((t,c)=>(e<c.start||c.end&&e+c.time>=c.end||a.isMatch(c.repeat,c.start,e)&&t.push(r(n(c.id,c,e),e,!1)),t)),t),this.completed.reduce(((t,a)=>(e>=a.start&&e<a.end&&t.push(r(a,e,!0)),t)),t),t.sort(((e,t)=>{var a=e.start-t.start;return a||(a=t.end-t.start-(e.end-e.start))||e.time-t.time})),this.cachedEvents[e]=t,t}getEventsWithPlaceholders(e,t=[],a=[]){for(;t.length>0&&!(e<t[t.length-1].end);)t.pop();return t.forEach((e=>a.push({id:-1}))),this.getEvents(e).reduce(((e,a)=>(t.some((e=>a.id===e.id))||(a.days>1&&t.push({id:a.id,end:a.end}),e.push(a)),e)),a),a}getPlannedEventsFilteredBySkip(e,t=[],a=[]){for(;t.length>0&&!(e<t[t.length-1].end);)t.pop();this.getEvents(e).reduce(((e,a)=>(t.some((e=>a.id===e.id))||a.completed||(a.days>1&&t.push({id:a.id,end:a.end}),e.push(a)),e)),a)}getPlannedEventsInInterval(e,t){const a=[],n=[];for(let r=e;r<t;r+=86400)this.getPlannedEventsFilteredBySkip(r,n,a);return a}calculateActualBalance(){return this.completed.reduce(((e,t)=>e+(t.credit-t.debit)),0)}getActualBalance(e){if(e<this.firstActualBalanceDate)return 0;if(e>this.lastActualBalanceDate)return this.lastActualBalance;if(void 0!==this.cachedActualBalance[e])return this.cachedActualBalance[e];const t=this.completed.reduce(((t,a)=>(e>a.start+a.time&&(t+=a.credit-a.debit),t)),0);return this.cachedActualBalance[e]=t,t}getPlannedBalance(e){if(e<this.firstActualBalanceDate)return 0;if(e<=this.lastActualBalanceDate)return this.getActualBalance(e);if(void 0!==this.cachedPlannedBalance[e])return this.cachedPlannedBalance[e];const t=this.getPlannedEventsInInterval(this.lastActualBalanceDate,e).reduce(((e,t)=>e+(t.credit-t.debit)),this.lastActualBalance);return this.cachedPlannedBalance[e]=t,t}getPlannedBalanceChange(e){return this.getEvents(e).reduce(((e,t)=>e+(t.credit-t.debit)),0)}prepareToStorage(){const e=this.completed.map((e=>c.eventToRaw(e))),t=this.plannedRepeatable.reduce(((e,t)=>(e.push(c.eventToRaw(t)),e)),[]);return this.planned.reduce(((e,t)=>(e.push(c.eventToRaw(t)),e)),t),{projectsList:this.projects,completedList:e,plannedList:t}}}const i='{"projectsList":[{"name":"Общий","background":"#4178bc","color":"white"},{"name":"Доход","background":"red","color":"white"},{"name":"Машина","background":"#aa71ff","color":"black"},{"name":"Медицина","background":"#fca7e4","color":"black"},{"name":"Дача","background":"#eecc16","color":"black"},{"name":"Рутина","background":"gray","color":"white"},{"name":"Квартира","background":"#8d9f9b","color":"white"},{"name":"Программирование","background":"#c95816","color":"white"},{"name":"Отдых","background":"#fd817d","color":"black"},{"name":"Участок","background":"#37a862","color":"white"},{"name":"Водопровод","background":"#66b8c8","color":"black"}],"completedList":[{"name":"Праздники","start":"2021-12-31","end":"2022-01-10"},{"name":"Нач остаток","project":"Доход","start":"2022-01-01","credit":"52683"},{"name":"Продукты","project":"Общий","start":"2022-01-04","debit":"3595.81"},{"name":"Продукты","project":"Общий","start":"2022-01-10","debit":"7981.27"},{"name":"ЗП +40020","project":"Доход","start":"2022-01-10","time":"10:00","credit":"40020"},{"name":"Купить лекарства","project":"Общий","start":"2022-01-10","debit":"1418"},{"name":"Заправить машину","project":"Машина","start":"2022-01-12","debit":"2732.46"},{"name":"Оплата электричества на даче","project":"Дача","start":"2022-01-15","debit":"0"},{"name":"Оплата телефона в машине","project":"Машина","start":"2022-01-15","debit":"100"},{"name":"Оплата электроэнергии","project":"Квартира","start":"2022-01-15","debit":"1716.08"},{"name":"Оплата интернета и телефона","project":"Квартира","start":"2022-01-15","debit":"858"},{"name":"Оплата капремонта","project":"Квартира","start":"2022-01-15","debit":"625.74"},{"name":"Продукты","project":"Общий","start":"2022-01-16","debit":"8022.22"},{"name":"Дистанционка","start":"2022-01-17","duration":"3d 0:00"},{"name":"пенсия мамы","project":"Доход","start":"2022-01-17","time":"9:00","credit":"32700"},{"name":"Сдал машину в ремонт","comment":"стоимость такси","project":"Машина","start":"2022-01-17","debit":"458.85"},{"name":"Дорога до сервиса","comment":"такси","project":"Машина","start":"2022-01-19","debit":"438.9"},{"name":"Ремонт электрики","project":"Машина","start":"2022-01-19","debit":"15500"},{"name":"Ремонт машины","comment":"омыватель, гофра выхлопной трубы, крепление глушителя, герметизация клапанной крышки, герметизация КПП","project":"Машина","start":"2022-01-22","debit":"35006"},{"name":"Продукты","project":"Общий","start":"2022-01-24","debit":"9377.18"},{"name":"Заправить машину","project":"Машина","start":"2022-01-24","debit":"2517.22"},{"name":"Оплата парковки","project":"Машина","start":"2022-01-24","debit":"2525"},{"name":"Оплата интернета на даче","project":"Дача","start":"2022-01-24","debit":"600"},{"name":"Оплата мобильного телефона","project":"Общий","start":"2022-01-24","debit":"270"},{"name":"Оплата квартплаты","project":"Квартира","start":"2022-01-24","debit":"5831.12"},{"name":"ЗП +25012","project":"Доход","start":"2022-01-25","time":"10:00","credit":"25012"},{"name":"Сохранение событий в localStorage","project":"Программирование","start":"2022-01-29"}],"plannedList":[{"name":"Продукты","project":"Общий","start":"2022-01-24","repeat":"* * 0","debit":"9000"},{"name":"Заправить машину","project":"Машина","start":"2022-01-30","repeat":"/6","debit":"2500"},{"name":"Оплата электроэнергии","project":"Общий","start":"2022-01-16","repeat":"15 * *","debit":"1500"},{"name":"Оплата капремонта","project":"Общий","start":"2022-01-16","repeat":"15 * *","debit":"625.74"},{"name":"Оплата интернета и телефона","project":"Общий","start":"2022-01-16","repeat":"15 * *","debit":"858"},{"name":"Оплата электричества на даче","project":"Дача","start":"2022-01-16","repeat":"15 * *","debit":"290"},{"name":"Оплата квартплаты","project":"Общий","start":"2022-01-26","repeat":"25 * *","debit":"5500"},{"name":"Оплата парковки","project":"Машина","start":"2022-01-26","repeat":"25 * *","debit":"2525"},{"name":"Оплата интернета на даче","project":"Дача","start":"2022-01-26","repeat":"25 * *","debit":"600"},{"name":"Купить лекарства","project":"Общий","start":"2022-01-11","repeat":"10 * *","debit":"2500"},{"name":"Оплата мобильного телефона","project":"Общий","start":"2022-01-26","repeat":"25 * *","debit":"300"},{"name":"Заказать фильтры для системы очистки воды","project":"Общий","start":"2022-05-01","repeat":"/180","debit":"5500"},{"name":"Выезд на дачу","project":"Дача","start":"2022-08-21","time":"8:00","repeat":"* * 6","end":"2022-10-01","debit":"3400"},{"name":"Выезд на дачу","project":"Дача","start":"2022-04-02","time":"8:00","repeat":"* * 6","end":"2022-05-28","debit":"3400"},{"name":"Выезд на дачу","project":"Дача","start":"2022-05-29","time":"8:00","repeat":"* * 6","end":"2022-07-09","debit":"3400"},{"name":"Выезд на дачу","project":"Дача","start":"2022-07-17","time":"8:00","repeat":"* * 6","end":"2022-08-20","debit":"3400"},{"name":"пенсия мамы","project":"Доход","start":"2022-01-18","time":"9:00","repeat":"17","duration":"0:20","credit":31000},{"name":"ЗП +40020","project":"Доход","start":"2022-01-26","time":"10:00","repeat":"10,25 * *","duration":"0:20","credit":40020},{"name":"Выезд в город","project":"Дача","start":"2022-08-15","time":"17:00","repeat":"* * 0","end":"2022-10-01","debit":"1800"},{"name":"Выезд в город","project":"Дача","start":"2022-05-09","time":"17:00","repeat":"* * 0","end":"2022-05-22","debit":"1800"},{"name":"Выезд в город","project":"Дача","start":"2022-06-13","time":"17:00","repeat":"* * 0","end":"2022-07-03","debit":"1800"},{"name":"Выезд в город","project":"Дача","start":"2022-07-11","time":"17:00","repeat":"* * 0","end":"2022-08-14","debit":"1800"},{"name":"Выезд в город","project":"Дача","start":"2022-04-03","time":"17:00","repeat":"* * 0","end":"2022-05-01","debit":"1800"},{"name":"Выезд в город","project":"Дача","start":"2022-05-23","time":"17:00","repeat":"* * 0","end":"2022-06-12","debit":"1800"},{"name":"Дистанционка, заболел","start":"2022-01-27","end":"2022-01-31"},{"name":"Перенос старых событий из Asana","project":"Программирование","start":"2022-01-30"},{"name":"Метод изменения параметров событий","project":"Программирование","start":"2022-01-30"},{"name":"Выходной","start":"2022-02-23"},{"name":"Выходной","start":"2022-03-06","duration":"3d 0:00"},{"name":"Выходные","start":"2022-04-30","end":"2022-05-04"},{"name":"Выезд в город","project":"Дача","start":"2022-05-03","time":"17:00","debit":"1800"},{"name":"Выходные","start":"2022-05-07","end":"2022-05-11"},{"name":"Выезд в город","project":"Дача","start":"2022-05-10","time":"17:00","debit":"1800"},{"name":"Ремонт кондиционера","project":"Машина","start":"2022-05-14","debit":"16000"},{"name":"Отпуск","start":"2022-05-21","end":"2022-05-30"},{"name":"Выходные","start":"2022-06-11","end":"2022-06-14"},{"name":"Выезд в город","project":"Дача","start":"2022-06-13","time":"17:00","debit":"1800"},{"name":"Отпуск","start":"2022-07-02","end":"2022-07-18"},{"name":"Отпуск","start":"2022-08-13","end":"2022-08-22"}]}';console.log("localStorage",i);const s=JSON.parse(i),d=new c(s?.completedList,s?.plannedList,s?.projectsList);function l({data:t,onAddEvent:a=(()=>{}),children:n=null}){const{timestamp:r,actualBalance:c,plannedBalance:i,plannedBalanceChange:s}=t,l=React.useRef(null),{day:o,month:m}=e.getDayMonthWeekday(r),u=e=>(e/1e3).toFixed(1);return React.createElement("div",{className:r>=d.lastActualBalanceDate?"day_d84e778":"before_actual_date_fb6a4cf",onClick:function(e){l&&l.current.focus()}},React.createElement("div",{className:"header_d741756"},o+(1==o?" "+e.MONTHS[m]:"")),React.createElement("div",{className:"balance_c271232"},u(i)+(0==s?"k":((p=s/1e3)>0?"+"+p.toFixed(1):p.toFixed(1))+"k")+" "+u(c)),React.createElement("div",null," ",n," "),React.createElement("div",{ref:l,className:"input_f2f0e78",contentEditable:"true",suppressContentEditableWarning:!0,onBlur:function(e){a(r,e.target.innerText),e.target.innerText=""},onKeyDown:function(e){"Enter"==e.key&&e.target.blur()}}));var p}function o({event:t,days:a,onClick:n=(e=>{})}){const{name:r,completed:c,background:i,color:s}=t;return-1===t.id?React.createElement("div",{className:"placeholder_c47b4a3"}):React.createElement("div",{className:c?"completed_b30da5e":"item_bb964bd",style:{width:1==a?"calc(100% + 2px)":"calc("+a+" * (100% + 1px) + 1px )",backgroundColor:i,color:s},onClick:e=>{e.stopPropagation(),n(t)}},React.createElement("div",{className:"name_ddde4d8"},r)," "+e.HHMMFromSeconds(t.time))}function m({isOpen:e=!1,onSubmit:t=(()=>{}),onCancel:a=(()=>{}),children:n=null}){return e&&React.createElement("div",{className:"modalOverlay_faa7164",onClick:a},React.createElement("div",{className:"modalWindow_fac41c2",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"modalBody_a8134eb"},n),React.createElement("div",{className:"modalFooter_dcf803f"},React.createElement("span",{className:"cancel_b0d96c0",onClick:a},"Cancel"),React.createElement("span",{className:"apply_dc7f5d7",onClick:t},"Apply"))))}function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u.apply(this,arguments)}function p({active:e=!1,disabled:t=!1,children:a="Button",...n}){return React.createElement("span",u({className:"button_c0afaa2 "+(e?"active_b40adfc":"")},n),a)}function h({name:e,style:t,children:a}){return React.createElement(React.Fragment,null,React.createElement("div",{className:"parameter_dcc1064",style:t},React.createElement("div",null,e),a)," ")}function b({inputRef:e,children:t}){return React.createElement("div",{ref:e,className:"value_f50ce86",contentEditable:"true",suppressContentEditableWarning:!0},t)}function g({event:e,onDelete:t=(e=>{}),onComplete:a=((e,t,a)=>{}),onAdd:n=(e=>{})}){const r=React.useRef(null),c=React.useRef(null),i=React.useRef(null),s=React.useRef(null),l=React.useRef(null),o=React.useRef(null),m=React.useRef(null),u=React.useRef(null),g=React.useRef(null),f=React.useRef(null),[R,E]=React.useState(e.repeat&&""!=e.repeat),v=!e.id;return console.log("event",e),React.createElement("div",{className:"form_aaccbc4"},!v&&React.createElement(p,{onClick:()=>{const t={name:r.current.innerText,comment:c.current.innerText,project:i.current.value,start:l.current.innerText,end:u.current.innerText,time:o.current.innerText,duration:m.current.innerText,credit:g.current.innerText,debit:f.current.innerText};a(e.id,e.timestamp,t)}},e.completed?"Mark uncompleted":"Complete"),!v&&React.createElement(p,{onClick:()=>t(e.id)},"Delete"),!v&&React.createElement(p,{onClick:()=>{}},"Save"),v&&React.createElement(p,{onClick:()=>{const e={name:r.current.innerText,comment:c.current.innerText,project:i.current.value,repeat:s.current.innerText,start:l.current.innerText,end:u.current.innerText,time:o.current.innerText,duration:m.current.innerText,credit:g.current.innerText,debit:f.current.innerText};n(e)}},"Add Event"),React.createElement("div",{ref:r,className:"name_c4b14a4",contentEditable:"true",suppressContentEditableWarning:!0},e.name??""),React.createElement(h,{name:"comment",style:{width:"100%"}},React.createElement(b,{inputRef:c},e.comment??"")),React.createElement("br",null),React.createElement(h,{name:"project",style:{minWidth:120}},React.createElement("select",{ref:i,defaultValue:e.project},React.createElement("option",{value:""},"Default"),d.projects.map(((e,t)=>React.createElement("option",{key:t,value:e.name},e.name))))),React.createElement("br",null),React.createElement(h,{name:"repeat",style:{minWidth:120}},React.createElement(b,{inputRef:s},e.repeat)),React.createElement("br",null),React.createElement(h,{name:"start date",style:{minWidth:110}},React.createElement(b,{inputRef:l},e.start?e.start:"")),React.createElement(h,{name:"time",style:{minWidth:60}},React.createElement(b,{inputRef:o},e.time?e.time:"")),React.createElement(h,{name:"duration",style:{minWidth:100}},React.createElement(b,{inputRef:m},e.duration?e.duration:"")),React.createElement(h,{name:"end date",style:{minWidth:110}},React.createElement(b,{inputRef:u},e.end?e.end:"")),React.createElement("br",null),React.createElement(h,{name:"credit",style:{minWidth:120}},React.createElement(b,{inputRef:g},e.credit?e.credit:"")),React.createElement(h,{name:"debit",style:{minWidth:120}},React.createElement(b,{inputRef:f},e.debit?e.debit:"")))}function f({children:t=null}){const a=(()=>{const[,e]=React.useState({});return React.useCallback((()=>e({})),[])})(),[n,r]=React.useState(!1),[i,s]=React.useState(4),u=React.useRef(null),h=React.useRef(null),[b,f]=React.useState({title:"Add new event",name:"New event"});let R=e.getBegintWeekTimestamp(Date.now()/1e3);const E=R;R-=7*i*86400,React.useEffect((()=>{s(6),u.current.scrollTop=604}),[]);const v=[];for(let e=0;e<=20;e++){v.push([]);let t=[];for(let a=0;a<=6;a++)v[e].push([]),v[e][a]={timestamp:R,tasks:d.getEventsWithPlaceholders(R,t),actualBalance:d.getActualBalance(R),plannedBalance:d.getPlannedBalance(R),plannedBalanceChange:d.getPlannedBalanceChange(R)},R+=86400}const j=(e,t)=>{""!==t&&(f(c.eventToRaw({name:t,start:e,time:null})),r(!0))},y=e=>{const{id:t,completed:a,start:n}=e,i=(a?d.completed.find((e=>e.id===t)):d.planned.find((e=>e.id===t)))??d.plannedRepeatable.find((e=>e.id===t));f({...c.eventToRaw(i),completed:a,timestamp:n,id:i.id}),r(!0)};return console.log("draw calendar"),React.createElement("div",{className:"wrapper_af90f78"},React.createElement("div",{className:"header_e3daf93"},React.createElement(p,{onClick:()=>{const e=JSON.stringify(d.prepareToStorage());localStorage.setItem("data",e),console.log(e)}},"Save to LocalStorage"),React.createElement(p,null,"Today"),React.createElement("span",{ref:h,className:"monthTitle_a8c3ab6"})),React.createElement("div",{className:"dayOfWeekLabels_cf63ad3"},e.WEEKDAYS.map(((e,t)=>React.createElement("div",{key:t},e)))),React.createElement("div",{className:"CalendarBody_b3637e9",onScroll:t=>{const a=t.target,n=a.scrollTop,r=a.scrollHeight-a.scrollTop-a.clientHeight,c=Math.ceil(n/151-i),d=new Date(1e3*(E+7*c*86400));h.current.innerText=d.getFullYear()+" "+e.MONTHS_FULL[d.getMonth()]+" "+c+" week",n<600?s((e=>e+4)):r<600&&s((e=>e-4))},ref:u},v.map((e=>React.createElement("div",{className:"CalendarWeek_ef509bf",key:e[0].timestamp}," ",e.map(((e,t)=>React.createElement(l,{data:e,key:e.timestamp,onAddEvent:j},e.tasks.map(((e,a)=>{return React.createElement(o,{key:a,event:e,days:(n=e.days,r=7-t,n<r?n:r),onClick:y});var n,r}))))))))),React.createElement(m,{isOpen:n,onCancel:()=>r(!1)},React.createElement(g,{event:b,onDelete:e=>{d.deleteEvent(e),r(!1),a()},onComplete:(e,t,n)=>{d.completeEvent(e,t,n),r(!1),a()},onAdd:e=>{d.addPlannedRawEvent(e),d.clearCache(),r(!1),a()}})))}function R(){return React.createElement(f,null)}ReactDOM.render(React.createElement(R,null),document.getElementById("root"))})();